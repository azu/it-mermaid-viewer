<!doctype html><html lang="en"><head><script nomodule defer src="/c4Diagram-b2a90758.01535749.js"></script><script nomodule defer src="/c4Diagram-b2a90758.runtime.96bd8873.js"></script><meta charset="utf-8"><title>it-mermaid-viewer</title><style>html,body{width:100%;height:100%;margin:0;padding:0;overflow:scroll}#graphDiv{width:100%;height:100%;margin:0;padding:0}x-mermaid-controller{z-index:1000;background-color:#f1f1f1;border-radius:1rem;padding:1rem;position:fixed;bottom:1rem;left:50%;transform:translate(-50%);box-shadow:0 0 1rem rgba(0,0,0,.1)}</style></head><body> <x-mermaid-controller target="graphDiv" graphid="mySvgId"> <template shadowrootmode="open"> <div> <style>#nextSequence,#prevSequence{color:#fff;cursor:pointer;background-color:#007bff;border:none;border-radius:.5rem;padding:.5rem 1rem;font-size:1rem}#nextSequence:hover,#prevSequence:hover{background-color:#0056b3}dialog{z-index:1000;background-color:#fff;border-radius:1rem;-ms-flex-direction:column;flex-direction:column;gap:1rem;width:100%;height:100%;padding:1rem;display:-ms-flexbox;display:flex;box-shadow:0 0 1rem rgba(0,0,0,.1)}.prevButton,.nextButton,.renderButton{color:#fff;cursor:pointer;background-color:#007bff;border:none;border-radius:.5rem;padding:.5rem 1rem;font-size:1rem}.prevButton:hover,.nextButton:hover,.renderButton:hover{background-color:#0056b3}#inputDialog{display:none}#inputDialog[open]{display:block}#inputDialogInput{width:80%;height:80%;display:block}.sequenceController{grid-column:3 label;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:end;align-items:end;margin:.5rem 0;display:-ms-flexbox;display:flex;position:relative}.sequenceNumberBox{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex}.sequenceNumberLabel{font-size:1.5rem;display:block}.sequenceStepper{margin-left:.8rem;margin-right:.8rem}.sequenceStepper:before{content:attr(min);margin-left:-.5rem;position:relative;bottom:0;left:0}.sequenceStepper:after{content:attr(max);margin-right:-.5rem;position:relative;top:0;right:0}.sequenceStepper{display:block}.editDialogBox{position:absolute;top:0;right:0}.openDialog{color:#fff;cursor:pointer;border:none;border-radius:.5rem;padding:.5rem 1rem;font-size:1rem}</style> <dialog id="inputDialog"> <textarea id="inputDialogInput"></textarea> <button id="inputDialogClose" class="renderButton">Render</button> <p> Tips: `autonumber` is useful for sequence diagram. </p> </dialog> <div id="sequenceController" class="sequenceController"> <button id="prevSequence" class="prevButton">Prev</button> <div class="sequenceNumberBox"> <label id="sequenceNumberLabel" class="sequenceNumberLabel" for="sequenceStepper">0</label> <input type="range" id="sequenceStepper" class="sequenceStepper" min="1" max="1" value="0"> </div> <button id="nextSequence" class="nextButton">Next</button> </div> <div class="editDialogBox"> <button id="openDialog" class="openDialog" title="Edit Diagram">üõ†Ô∏è</button> </div> </div> </template> </x-mermaid-controller> <div id="graphDiv"></div> <script>!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t,n,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},i={},a=r.parcelRequire44d4;null==a&&((a=function(e){if(e in o)return o[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){i[e]=t},r.parcelRequire44d4=a);var u=a.register;u("3o9tm",function(t,n){e(t.exports,"_",function(){return r});function r(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}}),u("eVvkm",function(t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}e(t.exports,"_",function(){return o})}),u("fCefb",function(t,n){e(t.exports,"_",function(){return c});var r=a("st1HL"),o=a("j4rtj"),i=a("a3SFK"),u=a("iiEjw");function c(e,t){return(0,r._array_with_holes)(e)||(0,o._iterable_to_array_limit)(e,t)||(0,u._unsupported_iterable_to_array)(e,t)||(0,i._non_iterable_rest)()}}),u("st1HL",function(t,n){e(t.exports,"_array_with_holes",function(){return r});function r(e){if(Array.isArray(e))return e}}),u("j4rtj",function(t,n){e(t.exports,"_iterable_to_array_limit",function(){return r});function r(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,u=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){u=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(u)throw r}}return i}}}),u("a3SFK",function(t,n){e(t.exports,"_non_iterable_rest",function(){return r});function r(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}}),u("iiEjw",function(t,n){e(t.exports,"_unsupported_iterable_to_array",function(){return o});var r=a("hn6IE");function o(e,t){if(e){if("string"==typeof e)return(0,r._array_like_to_array)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return(0,r._array_like_to_array)(e,t)}}}),u("hn6IE",function(t,n){e(t.exports,"_array_like_to_array",function(){return r});function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}}),u("acy6y",function(t,n){e(t.exports,"_",function(){return c});var r=a("gurs8"),o=a("d224A"),i=a("klRkV"),u=a("iiEjw");function c(e){return(0,r._array_without_holes)(e)||(0,o._iterable_to_array)(e)||(0,u._unsupported_iterable_to_array)(e)||(0,i._non_iterable_spread)()}}),u("gurs8",function(t,n){e(t.exports,"_array_without_holes",function(){return o});var r=a("hn6IE");function o(e){if(Array.isArray(e))return(0,r._array_like_to_array)(e)}}),u("d224A",function(t,n){e(t.exports,"_iterable_to_array",function(){return r});function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}}),u("klRkV",function(t,n){e(t.exports,"_non_iterable_spread",function(){return r});function r(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}});var c=a("eii2Q"),l=a("hMcdm"),s=a("3o9tm");function f(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function d(e,t){var n=f(e,t,"get");return n.get?n.get.call(e):n.value}function m(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function v(e,t,n){var r=f(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,r,n),n}var h=a("eVvkm"),p=a("bIGCV"),y=a("4HqLh"),b=a("kF9rg"),g=a("8IDHi"),w=a("fA0fn"),x=a("3WE8J"),_=a("1t9cm"),S=a("5GUWQ"),E={},q=a("6BtQu"),C={};function A(e,t,n){e.addEventListener("wheel",t,n)}(C=A).addWheelListener=A,C.removeWheelListener=function(e,t,n){e.removeEventListener("wheel",t,n)};var k={},M={},T="function"==typeof Float32Array;function N(e,t,n){return(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e}function L(e,t,n){return 3*(1-3*n+3*t)*e*e+2*(3*n-6*t)*e+3*t}function D(e){return e}var R={ease:(M=function(e,t,n,r){if(!(0<=e&&e<=1&&0<=n&&n<=1))throw Error("bezier x values must be in [0, 1] range");if(e===t&&n===r)return D;for(var o=T?new Float32Array(11):Array(11),i=0;i<11;++i)o[i]=N(.1*i,e,n);return function(i){return 0===i?0:1===i?1:N(function(t){for(var r=0,i=1;10!==i&&o[i]<=t;++i)r+=.1;var a=r+(t-o[--i])/(o[i+1]-o[i])*.1,u=L(a,e,n);return u>=.001?function(e,t,n,r){for(var o=0;o<4;++o){var i=L(t,n,r);if(0===i)break;var a=N(t,n,r)-e;t-=a/i}return t}(t,a,e,n):0===u?a:function(e,t,n,r,o){var i,a,u=0;do(i=N(a=t+(n-t)/2,r,o)-e)>0?n=a:t=a;while(Math.abs(i)>1e-7&&++u<10)return a}(t,r,r+.1,e,n)}(i),t,r)}})(.25,.1,.25,1),easeIn:M(.42,0,1,1),easeOut:M(0,0,.58,1),easeInOut:M(.42,0,.58,1),linear:M(0,0,1,1)};function B(){}function F(){var e=new Set,t=new Set,n=0;return{next:r,cancel:r,clearAll:function(){e.clear(),t.clear(),cancelAnimationFrame(n),n=0}};function r(e){t.add(e),n||(n=requestAnimationFrame(o))}function o(){n=0;var r=t;t=e,(e=r).forEach(function(e){e()}),e.clear()}}(k=function(e,t,n){var r,o=Object.create(null),i=Object.create(null),a="function"==typeof(n=n||{}).easing?n.easing:R[n.easing];a||(n.easing&&console.warn("Unknown easing function in amator: "+n.easing),a=R.ease);var u="function"==typeof n.step?n.step:B,c="function"==typeof n.done?n.done:B,l=function(e){if(!e)return"undefined"!=typeof window&&window.requestAnimationFrame?{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}:{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}};if("function"!=typeof e.next)throw Error("Scheduler is supposed to have next(cb) function");if("function"!=typeof e.cancel)throw Error("Scheduler is supposed to have cancel(handle) function");return e}(n.scheduler),s=Object.keys(t);s.forEach(function(n){o[n]=e[n],i[n]=t[n]-e[n]});var f=Math.max(1,.06*("number"==typeof n.duration?n.duration:400)),d=0;return r=l.next(function t(){var n=a(d/f);d+=1,s.forEach(function(t){e[t]=i[t]*n+o[t]}),d<=f?(r=l.next(t),u(e)):(r=0,setTimeout(function(){c(e)},0))}),{cancel:function(){l.cancel(r),r=0}}}).makeAggregateRaf=F,k.sharedScheduler=F();var I={};I=function(e){!function(e){if(!e)throw Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t,n=(t=Object.create(null),{on:function(n,r,o){if("function"!=typeof r)throw Error("callback is expected to be a function");var i=t[n];return i||(i=t[n]=[]),i.push({callback:r,ctx:o}),e},off:function(n,r){if(void 0===n)return t=Object.create(null),e;if(t[n]){if("function"!=typeof r)delete t[n];else for(var o=t[n],i=0;i<o.length;++i)o[i].callback===r&&o.splice(i,1)}return e},fire:function(n){var r,o=t[n];if(!o)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var i=0;i<o.length;++i){var a=o[i];a.callback.apply(a.ctx,r)}return e}});return e.on=n.on,e.off=n.off,e.fire=n.fire,e};var O={};O=function(e,t,n){"object"!=typeof n&&(n={});var r,o,i,a,u,c,l,s,f,d,m="number"==typeof n.minVelocity?n.minVelocity:5,v="number"==typeof n.amplitude?n.amplitude:.25,h="function"==typeof n.cancelAnimationFrame?n.cancelAnimationFrame:"function"==typeof cancelAnimationFrame?cancelAnimationFrame:clearTimeout,p="function"==typeof n.requestAnimationFrame?n.requestAnimationFrame:"function"==typeof requestAnimationFrame?requestAnimationFrame:function(e){return setTimeout(e,16)};return{start:function(){r=e(),c=f=a=l=0,o=new Date,h(i),h(d),i=p(y)},stop:function(){h(i),h(d);var t=e();u=t.x,s=t.y,o=Date.now(),(a<-m||a>m)&&(u+=c=v*a),(l<-m||l>m)&&(s+=f=v*l),d=p(b)},cancel:function(){h(i),h(d)}};function y(){var t=Date.now(),n=t-o;o=t;var u=e(),c=u.x-r.x,s=u.y-r.y;r=u;var f=1e3/(1+n);a=.8*c*f+.2*a,l=.8*s*f+.2*l,i=p(y)}function b(){var e=Date.now()-o,n=!1,r=0,i=0;c&&((r=-c*Math.exp(-e/342))>.5||r<-.5?n=!0:r=c=0),f&&((i=-f*Math.exp(-e/342))>.5||i<-.5?n=!0:i=f=0),n&&(t(u+r,s+i),d=p(b))}};var j={};function P(e){return e.stopPropagation(),!1}function z(){}var W=(j=function(e){if(e)return{capture:z,release:z};var t,n,r,o=!1;return{capture:function(e){o=!0,n=window.document.onselectstart,r=window.document.ondragstart,window.document.onselectstart=P,(t=e).ondragstart=P},release:function(){o&&(o=!1,window.document.onselectstart=n,t&&(t.ondragstart=r))}}})(),Z=j(!0),V={};V=function(){this.x=0,this.y=0,this.scale=1};var H={};function U(e){return e&&e.ownerSVGElement&&e.getCTM}(H=function(e,t){if(!U(e))throw Error("svg element is required for svg.panzoom to work");var n=e.ownerSVGElement;if(!n)throw Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");return t.disableKeyboardInteraction||n.setAttribute("tabindex",0),{getBBox:function(){var t=e.getBBox();return{left:t.x,top:t.y,width:t.width,height:t.height}},getScreenCTM:function(){return n.getCTM()||n.getScreenCTM()},getOwner:function(){return n},applyTransform:function(t){e.setAttribute("transform","matrix("+t.scale+" 0 0 "+t.scale+" "+t.x+" "+t.y+")")},initTransform:function(t){var r=e.getCTM();null===r&&(r=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),t.x=r.e,t.y=r.f,t.scale=r.a,n.removeAttributeNS(null,"viewBox")}}}).canAttach=U;var Y={};function G(e){return e&&e.parentElement&&e.style}function K(e,t){var n,r,o,i,a,u,c,l,s,f,d=(t=t||{}).controller;if(!d&&(H.canAttach(e)?d=H(e,t):Y.canAttach(e)&&(d=Y(e,t))),!d)throw Error("Cannot create panzoom for the current type of dom element");var m=d.getOwner(),v={x:0,y:0},h=!1,p=new V;d.initTransform&&d.initTransform(p);var y="function"==typeof t.filterKey?t.filterKey:Q,b="number"==typeof t.pinchSpeed?t.pinchSpeed:1,g=t.bounds,w="number"==typeof t.maxZoom?t.maxZoom:Number.POSITIVE_INFINITY,x="number"==typeof t.minZoom?t.minZoom:0,_="number"==typeof t.boundsPadding?t.boundsPadding:.05,S="number"==typeof t.zoomDoubleClickSpeed?t.zoomDoubleClickSpeed:1.75,E=t.beforeWheel||Q,A=t.beforeMouseDown||Q,M="number"==typeof t.zoomSpeed?t.zoomSpeed:1,T=X(t.transformOrigin),N=t.enableTextSelection?Z:W;(function(e){var t=void 0===e?"undefined":(0,q._)(e);if("undefined"!==t&&"boolean"!==t&&!($(e.left)&&$(e.top)&&$(e.bottom)&&$(e.right)))throw Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")})(g),t.autocenter&&function(){var e,t,n=0,r=0,o=er();if(o)n=o.left,r=o.top,e=o.right-o.left,t=o.bottom-o.top;else{var i=m.getBoundingClientRect();e=i.width,t=i.height}var a=d.getBBox();if(0!==a.width&&0!==a.height){var u=t/a.height,c=Math.min(e/a.width,u);p.x=-(a.left+a.width/2)*c+e/2+n,p.y=-(a.top+a.height/2)*c+t/2+r,p.scale=c}}();var L=0,D=!1,R=!1;u="smoothScroll"in t&&!t.smoothScroll?{start:Q,stop:Q,cancel:Q}:O(function(){return{x:p.x,y:p.y}},function(e,t){ek(),J(e,t)},t.smoothScroll);var B=!1;ec();var F={dispose:function(){el()},moveBy:eu,moveTo:J,smoothMoveTo:function(e,t){return eu(e-p.x,t-p.y,!0)},centerOn:function(e){var t=e.ownerSVGElement;if(!t)throw Error("ui element is required to be within the scene");var n=e.getBoundingClientRect(),r=n.left+n.width/2,o=n.top+n.height/2,i=t.getBoundingClientRect();return eu(i.width/2-r,i.height/2-o,!0)},zoomTo:eA,zoomAbs:ea,smoothZoom:eq,smoothZoomAbs:function(e,t,n){var r={scale:p.scale},o={scale:n};return ek(),new Promise(function(n,i){l=k(r,o,{step:function(n){ea(e,t,n.scale)},done:function(){eL(),eN(),n(!0)}})})},showRectangle:function(e){ek(),G(U(e))},smoothShowRectangle:function(e,t){ek();var n,r,o,i,a,u,c=(o=(r=K((n=m.getBoundingClientRect()).width,n.height)).x/p.scale,i=r.y/p.scale,a=-(p.x/p.scale),{top:u=-(p.y/p.scale),left:a,bottom:u+i,right:a+o}),l=600;return"function"==typeof t&&(l=t(c,e)),new Promise(function(t,n){s=k(c,e,{duration:l,step:function(e){G(U(e))},done:function(){eL(),eN(),t(!0)}})})},pause:function(){el(),B=!0},resume:function(){B&&(ec(),B=!1)},isPaused:function(){return B},getTransform:function(){return p},getMinZoom:function(){return x},setMinZoom:function(e){x=e},getMaxZoom:function(){return w},setMaxZoom:function(e){w=e},getTransformOrigin:function(){return T},setTransformOrigin:function(e){T=X(e)},getZoomSpeed:function(){return M},setZoomSpeed:function(e){if(!Number.isFinite(e))throw Error("Zoom speed should be a number");M=e}};I(F);var j="number"==typeof t.initialX?t.initialX:p.x,P="number"==typeof t.initialY?t.initialY:p.y,z="number"==typeof t.initialZoom?t.initialZoom:p.scale;return(j!=p.x||P!=p.y||z!=p.Scale)&&ea(j,P,z),F;function U(e){var t=m.getBoundingClientRect(),n=K(t.width,t.height),r=e.right-e.left,o=e.bottom-e.top;if(!Number.isFinite(r)||!Number.isFinite(o))throw Error("Invalid rectangle");var i=Math.min(n.x/r,n.y/o),a=new V;return a.x=-(e.left+r/2)*i+n.x/2,a.y=-(e.top+o/2)*i+n.y/2,a.scale=i,a}function G(e){p.x=e.x,p.y=e.y,p.scale=e.scale,eD("pan"),eD("zoom"),eo()}function K(e,t){if(d.getScreenCTM){var n=d.getScreenCTM(),r=n.a,o=n.d,i=n.e,a=n.f;v.x=e*r-i,v.y=t*o-a}else v.x=e,v.y=t;return v}function J(e,t){p.x=e,p.y=t,en(),eD("pan"),eo()}function et(e,t){J(p.x+e,p.y+t)}function en(){var e=er();if(e){var t,n,r,o,i=!1,a={left:(t=(r=d.getBBox()).left,n=r.top,o={x:t*p.scale+p.x,y:n*p.scale+p.y}).x,top:o.y,right:r.width*p.scale+o.x,bottom:r.height*p.scale+o.y},u=e.left-a.right;return u>0&&(p.x+=u,i=!0),(u=e.right-a.left)<0&&(p.x+=u,i=!0),(u=e.top-a.bottom)>0&&(p.y+=u,i=!0),(u=e.bottom-a.top)<0&&(p.y+=u,i=!0),i}}function er(){if(g){if("boolean"==typeof g){var e=m.getBoundingClientRect(),t=e.width,n=e.height;return{left:t*_,top:n*_,right:t*(1-_),bottom:n*(1-_)}}return g}}function eo(){h=!0,n=window.requestAnimationFrame(es)}function ei(e,t,n){if(ee(e)||ee(t)||ee(n))throw Error("zoom requires valid numbers");var r=p.scale*n;if(r<x){if(p.scale===x)return;n=x/p.scale}if(r>w){if(p.scale===w)return;n=w/p.scale}var o=K(e,t);p.x=o.x-n*(o.x-p.x),p.y=o.y-n*(o.y-p.y),g&&1===_&&1===x?(p.scale*=n,en()):en()||(p.scale*=n),eD("zoom"),eo()}function ea(e,t,n){ei(e,t,n/p.scale)}function eu(e,t,n){return new Promise(function(r,o){if(ek(),n){var i=0,a=0;c=k({x:0,y:0},{x:e,y:t},{step:function(e){et(e.x-i,e.y-a),i=e.x,a=e.y},done:function(){eL(),eN(),r(!0)}})}else et(e,t),eL(),eN(),r(!0)})}function ec(){m.addEventListener("mousedown",eb,{passive:!1}),m.addEventListener("dblclick",ey,{passive:!1}),m.addEventListener("touchstart",ed,{passive:!1}),m.addEventListener("keydown",ef,{passive:!1}),C.addWheelListener(m,eS,{passive:!1}),eo()}function el(){C.removeWheelListener(m,eS),m.removeEventListener("mousedown",eb),m.removeEventListener("keydown",ef),m.removeEventListener("dblclick",ey),m.removeEventListener("touchstart",ed),n&&(window.cancelAnimationFrame(n),n=0),ek(),ex(),e_(),N.release(),eN()}function es(){h&&(h=!1,d.applyTransform(p),eD("transform"),n=0)}function ef(e){var t=0,n=0,r=0;if(38===e.keyCode?n=1:40===e.keyCode?n=-1:37===e.keyCode?t=1:39===e.keyCode?t=-1:189===e.keyCode||109===e.keyCode?r=1:(187===e.keyCode||107===e.keyCode)&&(r=-1),!y(e,t,n,r)){if(t||n){e.preventDefault(),e.stopPropagation();var o=m.getBoundingClientRect(),i=Math.min(o.width,o.height);eu(.05*i*t,.05*i*n)}if(r){var a,u=eM(100*r),i=T?eC():{x:(a=m.getBoundingClientRect()).width/2,y:a.height/2};eA(i.x,i.y,u)}}}function ed(e){var n,u;if((!t.onTouch||t.onTouch(e))&&(e.stopPropagation(),e.preventDefault()),1===e.touches.length)return e.touches[0],r=n=eE(e.touches[0]),void(o=(u=K(n.x,n.y)).x,i=u.y,ek(),em());2===e.touches.length&&(a=ep(e.touches[0],e.touches[1]),f=!0,em())}function em(){D||(D=!0,document.addEventListener("touchmove",ev),document.addEventListener("touchend",eh),document.addEventListener("touchcancel",eh))}function ev(e){if(1===e.touches.length){e.stopPropagation();var t=eE(e.touches[0]),n=K(t.x,t.y),r=n.x-o,u=n.y-i;0!==r&&0!==u&&eT(),o=n.x,i=n.y,eu(r,u)}else if(2===e.touches.length){f=!0;var c=e.touches[0],l=e.touches[1],s=ep(c,l),d=1+(s/a-1)*b,m=eE(c),v=eE(l);if(o=(m.x+v.x)/2,i=(m.y+v.y)/2,T){var t=eC();o=t.x,i=t.y}eA(o,i,d),a=s,e.stopPropagation(),e.preventDefault()}}function eh(e){if(e.touches.length>0){var t=eE(e.touches[0]),n=K(t.x,t.y);o=n.x,i=n.y}else{var a=new Date;if(a-L<300){if(T){var t=eC();eq(t.x,t.y,S)}else eq(r.x,r.y,S)}L=a,eN(),e_()}}function ep(e,t){var n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function ey(e){t.onDoubleClick&&!t.onDoubleClick(e)||(e.preventDefault(),e.stopPropagation());var n=eE(e);T&&(n=eC()),eq(n.x,n.y,S)}function eb(e){if(!A(e)){if(D)return e.stopPropagation(),!1;if(!((1!==e.button||null===window.event)&&0!==e.button)){ek();var t=eE(e),n=K(t.x,t.y);return o=n.x,i=n.y,document.addEventListener("mousemove",eg),document.addEventListener("mouseup",ew),N.capture(e.target||e.srcElement),!1}}}function eg(e){if(!D){eT();var t=eE(e),n=K(t.x,t.y),r=n.x-o,a=n.y-i;o=n.x,i=n.y,eu(r,a)}}function ew(){N.release(),eN(),ex()}function ex(){document.removeEventListener("mousemove",eg),document.removeEventListener("mouseup",ew),R=!1}function e_(){document.removeEventListener("touchmove",ev),document.removeEventListener("touchend",eh),document.removeEventListener("touchcancel",eh),R=!1,f=!1,D=!1}function eS(e){if(!E(e)){ek();var t=e.deltaY;e.deltaMode>0&&(t*=100);var n=eM(t);if(1!==n){var r=T?eC():eE(e);eA(r.x,r.y,n),e.preventDefault()}}}function eE(e){var t=m.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}function eq(e,t,n){var r=p.scale,o={scale:r},i={scale:n*r};return ek(),new Promise(function(n,r){l=k(o,i,{step:function(n){ea(e,t,n.scale)},done:function(){eL(),eN(),n(!0)}})})}function eC(){var e=m.getBoundingClientRect();return{x:e.width*T.x,y:e.height*T.y}}function eA(e,t,n){return ek(),ei(e,t,n)}function ek(){s&&(s.cancel(),s=null),l&&(l.cancel(),l=null),c&&(c.cancel(),c=null),u.cancel()}function eM(e){var t=Math.min(.25,Math.abs(M*e/128));return 1-Math.sign(e)*t}function eT(){R||(eD("panstart"),R=!0,u.start())}function eN(){R&&(f||u.stop(),eD("panend"))}function eL(){eD("zoomend")}function eD(e){F.fire(e,F)}}function X(e){if(e){if("object"==typeof e)return $(e.x)&&$(e.y)||J(e),e;J()}}function J(e){throw console.error(e),Error('Cannot parse transform origin.\nSome good examples:\n  "center center" can be achieved with {x: 0.5, y: 0.5}\n  "top center" can be achieved with {x: 0.5, y: 0}\n  "bottom right" can be achieved with {x: 1, y: 1}')}function Q(){}function $(e){return Number.isFinite(e)}function ee(e){return Number.isNaN?Number.isNaN(e):e!=e}(Y=function(e,t){if(!G(e))throw Error("panzoom requires DOM element to be attached to the DOM tree");var n=e.parentElement;return e.scrollTop=0,t.disableKeyboardInteraction||n.setAttribute("tabindex",0),{getBBox:function(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}},getOwner:function(){return n},applyTransform:function(t){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+t.scale+", 0, 0, "+t.scale+", "+t.x+", "+t.y+")"}}}).canAttach=G,E=K,function(){if("undefined"!=typeof document){var e,t=document.getElementsByTagName("script");if(t){for(var n=0;n<t.length;++n){var r=t[n];if(r.src&&r.src.match(/\bpanzoom(\.min)?\.js/)){e=r;break}}if(e){var o=e.getAttribute("query");if(o){var i=e.getAttribute("name")||"pz",a=Date.now();!function t(){var n=document.querySelector(o);if(!n){if(Date.now()-a<2e3){setTimeout(t,100);return}console.error("Cannot find the panzoom element",i);return}var r=function(e){for(var t=e.attributes,n={},r=0;r<t.length;++r){var o=function(e){if(e.name&&"p"===e.name[0]&&"z"===e.name[1]&&"-"===e.name[2])return{name:e.name.substr(3),value:JSON.parse(e.value)}}(t[r]);o&&(n[o.name]=o.value)}return n}(e);console.log(r),window[i]=K(n,r)}()}}}}}();var et=function(e,t){var n=new URL(window.location.href);n.searchParams.set(e,t),window.history.replaceState({},"",n.toString())},en=new WeakMap,er=new WeakMap,eo=new WeakMap,ei=new WeakMap,ea=new WeakMap,eu=new WeakMap,ec=new WeakMap,el=new WeakMap,es=new WeakMap,ef=function(e){(0,p._)(n,e);var t=(0,x._)(n);function n(){if((0,s._)(this,n),e=t.call(this),m((0,c._)(e),en,{writable:!0,value:void 0}),m((0,c._)(e),er,{writable:!0,value:void 0}),m((0,c._)(e),eo,{writable:!0,value:void 0}),m((0,c._)(e),ei,{writable:!0,value:void 0}),m((0,c._)(e),ea,{writable:!0,value:void 0}),m((0,c._)(e),eu,{writable:!0,value:void 0}),m((0,c._)(e),ec,{writable:!0,value:void 0}),m((0,c._)(e),el,{writable:!0,value:void 0}),m((0,c._)(e),es,{writable:!0,value:void 0}),v((0,c._)(e),en,!1),e.updateSequenceNumber=function(t){var n;d((0,c._)(e),el)&&(null===(n=d((0,c._)(e),el))||void 0===n?void 0:n.sequenceNumber)&&(d(e,el).currentSequenceNumber=t,d(e,el).sequenceStepper.value=String(t),d(e,el).sequenceNumber.textContent=String(t))},!e.shadowRoot)return(0,g._)(e);v((0,c._)(e),eo,e.shadowRoot.querySelector("#graphDiv")),v((0,c._)(e),ei,e.shadowRoot.querySelector("#inputDialog")),v((0,c._)(e),eu,e.shadowRoot.querySelector("#inputDialogClose")),v((0,c._)(e),ea,e.shadowRoot.querySelector("#openDialog")),v((0,c._)(e),ec,e.shadowRoot.querySelector("#inputDialogInput")),d(e,eu).addEventListener("click",function(){e.closeInputDialog()}),v((0,c._)(e),el,{currentSequenceNumber:0,abortController:new AbortController,sequenceController:e.shadowRoot.querySelector("#sequenceController"),sequenceNumber:e.shadowRoot.querySelector("#sequenceNumberLabel"),sequenceStepper:e.shadowRoot.querySelector("#sequenceStepper"),nextSequence:e.shadowRoot.querySelector("#nextSequence"),prevSequence:e.shadowRoot.querySelector("#prevSequence")}),e.shadowRoot.addEventListener("mousedown",function(e){e.stopPropagation()},{passive:!1}),null===(r=d((0,c._)(e),ei))||void 0===r||r.addEventListener("wheel",function(e){e.stopPropagation()},{passive:!1}),d(e,el).sequenceStepper.addEventListener("keydown",function(e){e.stopPropagation()},{passive:!1}),e.shadowRoot.addEventListener("touchstart",function(e){e.stopPropagation()},{passive:!1}),d(e,ea).addEventListener("click",function(){e.openInputDialog()});var e,r,o=e.getAttribute("text");return o&&e.render(o).then(function(){e.updateController(),e.updateSequenceNumber(0)}).catch(function(e){console.error(e),window.alert("Fail to render: "+e.message)}),e}return(0,h._)(n,[{key:"updateController",value:function(){var e,t,n=d(this,el);if(!n)throw Error("sequenceController is not initialized");var r=null!==(t=null===(e=this.getAttribute("text"))||void 0===e?void 0:e.includes("sequenceDiagram"))&&void 0!==t&&t;n.sequenceController.style.display=r?"flex":"none",n.abortController.abort(),n.abortController=new AbortController;var o=this.createSequenceController();null==n||n.nextSequence.addEventListener("click",o.moveNext,{signal:null==n?void 0:n.abortController.signal}),null==n||n.prevSequence.addEventListener("click",o.movePrev,{signal:null==n?void 0:n.abortController.signal}),n.sequenceStepper.max=String(o.totalSequenceNumber),n.sequenceStepper.addEventListener("input",function(e){var t=Number(e.target.value);o.moveTo(t)},{signal:null==n?void 0:n.abortController.signal})}},{key:"attributeChangedCallback",value:function(e,t,n){var r=this;if("text"===e){if(!n)return;this.render(n).then(function(){r.updateController(),r.updateSequenceNumber(0),d(r,ec)&&(d(r,ec).value=n),r.dispatchEvent(new CustomEvent("change",{detail:{text:n}}))}).catch(function(e){console.error(e),window.alert("Fail to render: "+e.message)})}}},{key:"openInputDialog",value:function(){var e,t;v(this,en,!0),null===(e=d(this,ei))||void 0===e||e.showModal(),null===(t=d(this,ec))||void 0===t||t.focus()}},{key:"closeInputDialog",value:function(){var e,t,n;v(this,en,!1),null===(e=d(this,ei))||void 0===e||e.close(),this.setAttribute("text",null!==(n=null===(t=d(this,ec))||void 0===t?void 0:t.value)&&void 0!==n?n:"")}},{key:"render",value:function(e){var t=this;return(0,l._)(function(){var n,r,o,i,a;return(0,_.__generator)(this,function(u){switch(u.label){case 0:if(!e)return[2];if((0,S.N).initialize({startOnLoad:!1,sequence:{showSequenceNumbers:!0}}),d(t,es)&&d(t,es).dispose(),r=null!==(n=t.getAttribute("mySvgId"))&&void 0!==n?n:"mySvgId",(o=t.getAttribute("target"))||(o="graphDiv"),!(i=document.getElementById(o)))throw Error("Target element not found");return[4,(0,S.N).render(r,e)];case 1:var c;return a=u.sent().svg,i.innerHTML=a.replace(/[ ]*max-width:[ 0-9\.]*px;/i,""),v(t,es,((c=E)&&c.__esModule?c.default:c)(i)),[4,new Promise(function(e){setTimeout(function(){e()},200)})];case 2:return u.sent(),[2]}})})()}},{key:"createSequenceController",value:function(){var e,t,n=this,r=null===(t=d(this,eo))||void 0===t?void 0:null===(e=t.getAttribute("viewBox"))||void 0===e?void 0:e.split(" ").map(function(e){return Number(e)});null==r||r[2],null==r||r[3];var o=Array.from(document.querySelectorAll("#".concat(this.getAttribute("target")," .sequenceNumber"))).map(function(e){return{number:Number(e.textContent),rect:e.getBoundingClientRect()}}),i=o.length,a=this.getAttribute("target");a||(a="graphDiv");var u=function(e){return o.find(function(t){return t.number===e})},c=function(e){var t=d(n,es);if(t){var r=e.rect;t.smoothShowRectangle((0,b._)((0,y._)({},r.toJSON()),{left:r.left-150,top:r.top-150,right:r.right+150,bottom:r.bottom+150}),function(e,t){var n=Math.exp(Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.right-t.right,2)+Math.pow(e.bottom-t.bottom,2)+Math.pow(e.left-t.left,2))/1e3);return 1e3*n/(n+1)})}};return{totalSequenceNumber:i,moveTo:function(e){var t=u(e);t&&(c(t),n.updateSequenceNumber(e))},moveNext:function(){var e,t,r=Math.max(0,(null!==(t=null===(e=d(n,el))||void 0===e?void 0:e.currentSequenceNumber)&&void 0!==t?t:0)+1),o=u(r);o&&(c(o),n.updateSequenceNumber(r))},movePrev:function(){var e,t,r=Math.max(0,(null!==(t=null===(e=d(n,el))||void 0===e?void 0:e.currentSequenceNumber)&&void 0!==t?t:0)-1),o=u(r);o&&(c(o),n.updateSequenceNumber(r))}}}}]),n}((0,w._)(HTMLElement));ef.observedAttributes=["text"],customElements.define("x-mermaid-controller",ef);var ed=document.querySelector("x-mermaid-controller");ed.setAttribute("text",null!==(t="text",n=new URL(window.location.href).searchParams.get(t)||null)&&void 0!==n?n:"sequenceDiagram\n    autonumber\n    Alice->>Bob: Hello Bob, how are you ?\n    Bob->>Alice: Fine, thank you. And you?\n    create participant Carl\n    Alice->>Carl: Hi Carl!\n    create actor D as Donald\n    Carl->>D: Hi!\n    destroy Carl\n    Alice-xCarl: We are too many\n    destroy Bob\n    Bob->>Alice: I agree\n"),ed.addEventListener("change",function(e){et("text",e.detail.text)})}();</script> </body></html>