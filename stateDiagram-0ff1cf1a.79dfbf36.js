!function(){function t(t,e,r,a){Object.defineProperty(t,e,{get:r,set:a,enumerable:!0,configurable:!0})}var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire44d4,r=e.register;r("6eYJP",function(r,a){t(r.exports,"diagram",function(){return k});var n,i=e("76wyh"),o=e("Knj1d"),d=e("1RzZk"),s=e("ewvVJ"),c=e("5GUWQ");e("6fO6W"),e("biwpL"),e("gyk94"),e("cDk4l");var l={},u=function(t,e){l[t]=e},p=function(t,e){var r=t.append("text").attr("x",2*(0,c.c)().state.padding).attr("y",(0,c.c)().state.textHeight+2*(0,c.c)().state.padding).attr("font-size",(0,c.c)().state.fontSize).attr("class","state-title").text(e.id),a=r.node().getBBox();return t.insert("rect",":first-child").attr("x",(0,c.c)().state.padding).attr("y",(0,c.c)().state.padding).attr("width",a.width+2*(0,c.c)().state.padding).attr("height",a.height+2*(0,c.c)().state.padding).attr("rx",(0,c.c)().state.radius),r},g=function(t,e){var r=function(t,e,r){var a=t.append("tspan").attr("x",2*(0,c.c)().state.padding).text(e);r||a.attr("dy",(0,c.c)().state.textHeight)},a=t.append("text").attr("x",2*(0,c.c)().state.padding).attr("y",(0,c.c)().state.textHeight+1.3*(0,c.c)().state.padding).attr("font-size",(0,c.c)().state.fontSize).attr("class","state-title").text(e.descriptions[0]).node().getBBox(),n=a.height,i=t.append("text").attr("x",(0,c.c)().state.padding).attr("y",n+.4*(0,c.c)().state.padding+(0,c.c)().state.dividerMargin+(0,c.c)().state.textHeight).attr("class","state-description"),o=!0,d=!0;e.descriptions.forEach(function(t){o||(r(i,t,d),d=!1),o=!1});var s=t.append("line").attr("x1",(0,c.c)().state.padding).attr("y1",(0,c.c)().state.padding+n+(0,c.c)().state.dividerMargin/2).attr("y2",(0,c.c)().state.padding+n+(0,c.c)().state.dividerMargin/2).attr("class","descr-divider"),l=i.node().getBBox(),u=Math.max(l.width,a.width);return s.attr("x2",u+3*(0,c.c)().state.padding),t.insert("rect",":first-child").attr("x",(0,c.c)().state.padding).attr("y",(0,c.c)().state.padding).attr("width",u+2*(0,c.c)().state.padding).attr("height",l.height+n+2*(0,c.c)().state.padding).attr("rx",(0,c.c)().state.radius),t},h=function(t,e,r){var a,n=(0,c.c)().state.padding,i=2*(0,c.c)().state.padding,o=t.node().getBBox(),d=o.width,s=o.x,l=t.append("text").attr("x",0).attr("y",(0,c.c)().state.titleShift).attr("font-size",(0,c.c)().state.fontSize).attr("class","state-title").text(e.id),u=l.node().getBBox().width+i,p=Math.max(u,d);p===d&&(p+=i);var g=t.node().getBBox();e.doc,a=s-n,u>d&&(a=(d-p)/2+n),Math.abs(s-g.x)<n&&u>d&&(a=s-(u-d)/2);var h=1-(0,c.c)().state.textHeight;return t.insert("rect",":first-child").attr("x",a).attr("y",h).attr("class",r?"alt-composit":"composit").attr("width",p).attr("height",g.height+(0,c.c)().state.textHeight+(0,c.c)().state.titleShift+1).attr("rx","0"),l.attr("x",a+n),u<=d&&l.attr("x",s+(p-i)/2-u/2+n),t.insert("rect",":first-child").attr("x",a).attr("y",(0,c.c)().state.titleShift-(0,c.c)().state.textHeight-(0,c.c)().state.padding).attr("width",p).attr("height",3*(0,c.c)().state.textHeight).attr("rx",(0,c.c)().state.radius),t.insert("rect",":first-child").attr("x",a).attr("y",(0,c.c)().state.titleShift-(0,c.c)().state.textHeight-(0,c.c)().state.padding).attr("width",p).attr("height",g.height+3+2*(0,c.c)().state.textHeight).attr("rx",(0,c.c)().state.radius),t},f=function(t,e){var r=(0,c.c)().state.forkWidth,a=(0,c.c)().state.forkHeight;if(e.parentId){var n=r;r=a,a=n}return t.append("rect").style("stroke","black").style("fill","black").attr("width",r).attr("height",a).attr("x",(0,c.c)().state.padding).attr("y",(0,c.c)().state.padding)},y=function(t,e,r,a){var n=0,i=a.append("text");i.style("text-anchor","start"),i.attr("class","noteText");var o=t.replace(/\r\n/g,"<br/>"),d=(o=o.replace(/\n/g,"<br/>")).split(c.e.lineBreakRegex),s=1.25*(0,c.c)().state.noteMargin,l=!0,u=!1,p=void 0;try{for(var g,h=d[Symbol.iterator]();!(l=(g=h.next()).done);l=!0){var f=g.value.trim();if(f.length>0){var y=i.append("tspan");if(y.text(f),0===s){var x=y.node().getBBox();s+=x.height}n+=s,y.attr("x",e+(0,c.c)().state.noteMargin),y.attr("y",r+n+1.25*(0,c.c)().state.noteMargin)}}}catch(t){u=!0,p=t}finally{try{l||null==h.return||h.return()}finally{if(u)throw p}}return{textWidth:i.node().getBBox().width,textHeight:n}},x=function(t,e){e.attr("class","state-note");var r=e.append("rect").attr("x",0).attr("y",(0,c.c)().state.padding),a=y(t,0,0,e.append("g")),n=a.textWidth,i=a.textHeight;return r.attr("height",i+2*(0,c.c)().state.noteMargin),r.attr("width",n+2*(0,c.c)().state.noteMargin),r},v=function(t,e){var r=e.id,a={id:r,label:e.id,width:0,height:0},n=t.append("g").attr("id",r).attr("class","stateGroup");"start"===e.type&&n.append("circle").attr("class","start-state").attr("r",(0,c.c)().state.sizeUnit).attr("cx",(0,c.c)().state.padding+(0,c.c)().state.sizeUnit).attr("cy",(0,c.c)().state.padding+(0,c.c)().state.sizeUnit),"end"===e.type&&(n.append("circle").attr("class","end-state-outer").attr("r",(0,c.c)().state.sizeUnit+(0,c.c)().state.miniPadding).attr("cx",(0,c.c)().state.padding+(0,c.c)().state.sizeUnit+(0,c.c)().state.miniPadding).attr("cy",(0,c.c)().state.padding+(0,c.c)().state.sizeUnit+(0,c.c)().state.miniPadding),n.append("circle").attr("class","end-state-inner").attr("r",(0,c.c)().state.sizeUnit).attr("cx",(0,c.c)().state.padding+(0,c.c)().state.sizeUnit+2).attr("cy",(0,c.c)().state.padding+(0,c.c)().state.sizeUnit+2)),("fork"===e.type||"join"===e.type)&&f(n,e),"note"===e.type&&x(e.note.text,n),"divider"===e.type&&n.append("line").style("stroke","grey").style("stroke-dasharray","3").attr("x1",(0,c.c)().state.textHeight).attr("class","divider").attr("x2",2*(0,c.c)().state.textHeight).attr("y1",0).attr("y2",0),"default"===e.type&&0===e.descriptions.length&&p(n,e),"default"===e.type&&e.descriptions.length>0&&g(n,e);var i=n.node().getBBox();return a.width=i.width+2*(0,c.c)().state.padding,a.height=i.height+2*(0,c.c)().state.padding,u(r,a),a},b=0,_=function(t,e,r){e.points=e.points.filter(function(t){return!Number.isNaN(t.y)});var a=e.points,n=(0,o.line)().x(function(t){return t.x}).y(function(t){return t.y}).curve(o.curveBasis),d=t.append("path").attr("d",n(a)).attr("id","edge"+b).attr("class","transition"),s="";if((0,c.c)().state.arrowMarkerAbsolute&&(s=(s=(s=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")),d.attr("marker-end","url("+s+"#"+function(t){switch(t){case i.d.relationType.AGGREGATION:return"aggregation";case i.d.relationType.EXTENSION:return"extension";case i.d.relationType.COMPOSITION:return"composition";case i.d.relationType.DEPENDENCY:return"dependency"}}(i.d.relationType.DEPENDENCY)+"End)"),void 0!==r.title){for(var l=t.append("g").attr("class","stateLabel"),u=(0,c.u).calcLabelPosition(e.points),p=u.x,g=u.y,h=(0,c.e).getRows(r.title),f=0,y=[],x=0,v=0,_=0;_<=h.length;_++){var w=l.append("text").attr("text-anchor","middle").text(h[_]).attr("x",p).attr("y",g+f),m=w.node().getBBox();x=Math.max(x,m.width),v=Math.min(v,m.x),(0,c.l).info(m.x,p,g+f),0===f&&(f=w.node().getBBox().height,(0,c.l).info("Title height",f,g)),y.push(w)}var B=f*h.length;if(h.length>1){var k=(h.length-1)*f*.5;y.forEach(function(t,e){return t.attr("y",g+e*f-k)}),B=f*h.length}var E=l.node().getBBox();l.insert("rect",":first-child").attr("class","box").attr("x",p-x/2-(0,c.c)().state.padding/2).attr("y",g-B/2-(0,c.c)().state.padding/2-3.5).attr("width",x+(0,c.c)().state.padding).attr("height",B+(0,c.c)().state.padding),(0,c.l).info(E)}b++},w={},m=function(t){t.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},B=function(t,e,r,a,i,o,l){var u=new s.Graph({compound:!0,multigraph:!0}),p=!0;for(k=0;k<t.length;k++)if("relation"===t[k].stmt){p=!1;break}r?u.setGraph({rankdir:"LR",multigraph:!0,compound:!0,ranker:"tight-tree",ranksep:p?1:n.edgeLengthFactor,nodeSep:p?1:50,isMultiGraph:!0}):u.setGraph({rankdir:"TB",multigraph:!0,compound:!0,ranksep:p?1:n.edgeLengthFactor,nodeSep:p?1:50,ranker:"tight-tree",isMultiGraph:!0}),u.setDefaultEdgeLabel(function(){return{}}),l.db.extract(t);var g=l.db.getStates(),f=l.db.getRelations(),y=Object.keys(g),x=!0,b=!1,m=void 0;try{for(var k,E,S=y[Symbol.iterator]();!(x=(E=S.next()).done);x=!0){var N=g[E.value];r&&(N.parentId=r);var M=void 0;if(N.doc){var A=e.append("g").attr("id",N.id).attr("class","stateGroup");M=B(N.doc,A,N.id,!a,i,o,l);var H=(A=h(A,N,a)).node().getBBox();M.width=H.width,M.height=H.height+n.padding/2,w[N.id]={y:n.compositTitleSize}}else M=v(e,N);if(N.note){var z={descriptions:[],id:N.id+"-note",note:N.note,type:"note"},T=v(e,z);"left of"===N.note.position?(u.setNode(M.id+"-note",T),u.setNode(M.id,M)):(u.setNode(M.id,M),u.setNode(M.id+"-note",T)),u.setParent(M.id,M.id+"-group"),u.setParent(M.id+"-note",M.id+"-group")}else u.setNode(M.id,M)}}catch(t){b=!0,m=t}finally{try{x||null==S.return||S.return()}finally{if(b)throw m}}(0,c.l).debug("Count=",u.nodeCount(),u);var j=0;f.forEach(function(t){var e;j++,(0,c.l).debug("Setting edge",t),u.setEdge(t.id1,t.id2,{relation:t,width:(e=t.title)?e.length*n.fontSizeFactor:1,height:n.labelHeight*(0,c.e).getRows(t.title).length,labelpos:"c"},"id"+j)}),(0,d.layout)(u),(0,c.l).debug("Graph after layout",u.nodes());var I=e.node();u.nodes().forEach(function(t){void 0!==t&&void 0!==u.node(t)?((0,c.l).warn("Node "+t+": "+JSON.stringify(u.node(t))),i.select("#"+I.id+" #"+t).attr("transform","translate("+(u.node(t).x-u.node(t).width/2)+","+(u.node(t).y+(w[t]?w[t].y:0)-u.node(t).height/2)+" )"),i.select("#"+I.id+" #"+t).attr("data-x-shift",u.node(t).x-u.node(t).width/2),o.querySelectorAll("#"+I.id+" #"+t+" .divider").forEach(function(t){var e=t.parentElement,r=0,a=0;e&&(e.parentElement&&(r=e.parentElement.getBBox().width),Number.isNaN(a=parseInt(e.getAttribute("data-x-shift"),10))&&(a=0)),t.setAttribute("x1",0-a+8),t.setAttribute("x2",r-a-8)})):(0,c.l).debug("No Node "+t+": "+JSON.stringify(u.node(t)))});var O=I.getBBox();u.edges().forEach(function(t){void 0!==t&&void 0!==u.edge(t)&&((0,c.l).debug("Edge "+t.v+" -> "+t.w+": "+JSON.stringify(u.edge(t))),_(e,u.edge(t),u.edge(t).relation))}),O=I.getBBox();var L={id:r||"root",label:r||"root",width:0,height:0};return L.width=O.width+2*n.padding,L.height=O.height+2*n.padding,(0,c.l).debug("Doc rendered",L,u),L},k={parser:i.p,db:i.d,renderer:{setConf:function(){},draw:function(t,e,r,a){n=(0,c.c)().state;var i,d=(0,c.c)().securityLevel;"sandbox"===d&&(i=(0,o.select)("#i"+e));var s="sandbox"===d?(0,o.select)(i.nodes()[0].contentDocument.body):(0,o.select)("body"),l="sandbox"===d?i.nodes()[0].contentDocument:document;(0,c.l).debug("Rendering diagram "+t);var u=s.select("[id='".concat(e,"']"));m(u),B(a.db.getRootDoc(),u,void 0,!1,s,l,a);var p=n.padding,g=u.node().getBBox(),h=g.width+2*p,f=g.height+2*p;(0,c.i)(u,f,1.75*h,n.useMaxWidth),u.attr("viewBox","".concat(g.x-n.padding,"  ").concat(g.y-n.padding," ")+h+" "+f)}},styles:i.s,init:function(t){t.state||(t.state={}),t.state.arrowMarkerAbsolute=t.arrowMarkerAbsolute,(0,i.d).clear()}}}),r("3o9tm",function(e,r){t(e.exports,"_",function(){return a});function a(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}}),r("eVvkm",function(e,r){function a(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function n(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}t(e.exports,"_",function(){return n})}),r("fCefb",function(r,a){t(r.exports,"_",function(){return s});var n=e("st1HL"),i=e("j4rtj"),o=e("a3SFK"),d=e("iiEjw");function s(t,e){return(0,n._array_with_holes)(t)||(0,i._iterable_to_array_limit)(t,e)||(0,d._unsupported_iterable_to_array)(t,e)||(0,o._non_iterable_rest)()}}),r("st1HL",function(e,r){t(e.exports,"_array_with_holes",function(){return a});function a(t){if(Array.isArray(t))return t}}),r("j4rtj",function(e,r){t(e.exports,"_iterable_to_array_limit",function(){return a});function a(t,e){var r,a,n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i=[],o=!0,d=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){d=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(d)throw a}}return i}}}),r("a3SFK",function(e,r){t(e.exports,"_non_iterable_rest",function(){return a});function a(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}}),r("iiEjw",function(r,a){t(r.exports,"_unsupported_iterable_to_array",function(){return i});var n=e("hn6IE");function i(t,e){if(t){if("string"==typeof t)return(0,n._array_like_to_array)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return(0,n._array_like_to_array)(t,e)}}}),r("hn6IE",function(e,r){t(e.exports,"_array_like_to_array",function(){return a});function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}}),r("acy6y",function(r,a){t(r.exports,"_",function(){return s});var n=e("gurs8"),i=e("d224A"),o=e("klRkV"),d=e("iiEjw");function s(t){return(0,n._array_without_holes)(t)||(0,i._iterable_to_array)(t)||(0,d._unsupported_iterable_to_array)(t)||(0,o._non_iterable_spread)()}}),r("gurs8",function(r,a){t(r.exports,"_array_without_holes",function(){return i});var n=e("hn6IE");function i(t){if(Array.isArray(t))return(0,n._array_like_to_array)(t)}}),r("d224A",function(e,r){t(e.exports,"_iterable_to_array",function(){return a});function a(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}}),r("klRkV",function(e,r){t(e.exports,"_non_iterable_spread",function(){return a});function a(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})}();
//# sourceMappingURL=stateDiagram-0ff1cf1a.79dfbf36.js.map
